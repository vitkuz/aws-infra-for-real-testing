"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.handler = void 0;
const aws_logger_1 = require("@vitkuz/aws-logger");
exports.handler = (0, aws_logger_1.withLogger)(async (event, context) => {
    const logger = (0, aws_logger_1.getLogger)();
    if (!logger)
        throw new Error('Logger context missing');
    const headers = event.headers || {};
    // API Gateway V2 lowercases headers
    const requestId = headers['x-request-id'];
    const childLogger = logger.child(requestId ? { [aws_logger_1.REQUEST_ID_KEY]: requestId } : {});
    childLogger.info('HTTP API Handler Invoked', {
        data: {
            path: event.requestContext.http.path,
            method: event.requestContext.http.method,
            queryParams: event.queryStringParameters,
            requestId
        }
    });
    return {
        statusCode: 200,
        body: JSON.stringify({
            message: 'Hello from Vitkuz Testing HTTP API',
            path: event.requestContext.http.path,
            method: event.requestContext.http.method,
            requestId: requestId || context.awsRequestId
        }),
        headers: {
            'Content-Type': 'application/json'
        }
    };
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFDQSxtREFBMkU7QUFFOUQsUUFBQSxPQUFPLEdBQUcsSUFBQSx1QkFBVSxFQUFDLEtBQUssRUFBRSxLQUE2QixFQUFFLE9BQWdCLEVBQUUsRUFBRTtJQUN4RixNQUFNLE1BQU0sR0FBRyxJQUFBLHNCQUFTLEdBQUUsQ0FBQztJQUMzQixJQUFJLENBQUMsTUFBTTtRQUFFLE1BQU0sSUFBSSxLQUFLLENBQUMsd0JBQXdCLENBQUMsQ0FBQztJQUV2RCxNQUFNLE9BQU8sR0FBRyxLQUFLLENBQUMsT0FBTyxJQUFJLEVBQUUsQ0FBQztJQUNwQyxvQ0FBb0M7SUFDcEMsTUFBTSxTQUFTLEdBQUcsT0FBTyxDQUFDLGNBQWMsQ0FBQyxDQUFDO0lBRTFDLE1BQU0sV0FBVyxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsMkJBQWMsQ0FBQyxFQUFFLFNBQVMsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUVuRixXQUFXLENBQUMsSUFBSSxDQUFDLDBCQUEwQixFQUFFO1FBQ3pDLElBQUksRUFBRTtZQUNGLElBQUksRUFBRSxLQUFLLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxJQUFJO1lBQ3BDLE1BQU0sRUFBRSxLQUFLLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxNQUFNO1lBQ3hDLFdBQVcsRUFBRSxLQUFLLENBQUMscUJBQXFCO1lBQ3hDLFNBQVM7U0FDWjtLQUNKLENBQUMsQ0FBQztJQUVILE9BQU87UUFDSCxVQUFVLEVBQUUsR0FBRztRQUNmLElBQUksRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDO1lBQ2pCLE9BQU8sRUFBRSxvQ0FBb0M7WUFDN0MsSUFBSSxFQUFFLEtBQUssQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLElBQUk7WUFDcEMsTUFBTSxFQUFFLEtBQUssQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLE1BQU07WUFDeEMsU0FBUyxFQUFFLFNBQVMsSUFBSSxPQUFPLENBQUMsWUFBWTtTQUMvQyxDQUFDO1FBQ0YsT0FBTyxFQUFFO1lBQ0wsY0FBYyxFQUFFLGtCQUFrQjtTQUNyQztLQUNKLENBQUM7QUFDTixDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFQSUdhdGV3YXlQcm94eUV2ZW50VjIsIENvbnRleHQgfSBmcm9tICdhd3MtbGFtYmRhJztcbmltcG9ydCB7IHdpdGhMb2dnZXIsIGdldExvZ2dlciwgUkVRVUVTVF9JRF9LRVkgfSBmcm9tICdAdml0a3V6L2F3cy1sb2dnZXInO1xuXG5leHBvcnQgY29uc3QgaGFuZGxlciA9IHdpdGhMb2dnZXIoYXN5bmMgKGV2ZW50OiBBUElHYXRld2F5UHJveHlFdmVudFYyLCBjb250ZXh0OiBDb250ZXh0KSA9PiB7XG4gICAgY29uc3QgbG9nZ2VyID0gZ2V0TG9nZ2VyKCk7XG4gICAgaWYgKCFsb2dnZXIpIHRocm93IG5ldyBFcnJvcignTG9nZ2VyIGNvbnRleHQgbWlzc2luZycpO1xuXG4gICAgY29uc3QgaGVhZGVycyA9IGV2ZW50LmhlYWRlcnMgfHwge307XG4gICAgLy8gQVBJIEdhdGV3YXkgVjIgbG93ZXJjYXNlcyBoZWFkZXJzXG4gICAgY29uc3QgcmVxdWVzdElkID0gaGVhZGVyc1sneC1yZXF1ZXN0LWlkJ107XG5cbiAgICBjb25zdCBjaGlsZExvZ2dlciA9IGxvZ2dlci5jaGlsZChyZXF1ZXN0SWQgPyB7IFtSRVFVRVNUX0lEX0tFWV06IHJlcXVlc3RJZCB9IDoge30pO1xuXG4gICAgY2hpbGRMb2dnZXIuaW5mbygnSFRUUCBBUEkgSGFuZGxlciBJbnZva2VkJywge1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBwYXRoOiBldmVudC5yZXF1ZXN0Q29udGV4dC5odHRwLnBhdGgsXG4gICAgICAgICAgICBtZXRob2Q6IGV2ZW50LnJlcXVlc3RDb250ZXh0Lmh0dHAubWV0aG9kLFxuICAgICAgICAgICAgcXVlcnlQYXJhbXM6IGV2ZW50LnF1ZXJ5U3RyaW5nUGFyYW1ldGVycyxcbiAgICAgICAgICAgIHJlcXVlc3RJZFxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBzdGF0dXNDb2RlOiAyMDAsXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdIZWxsbyBmcm9tIFZpdGt1eiBUZXN0aW5nIEhUVFAgQVBJJyxcbiAgICAgICAgICAgIHBhdGg6IGV2ZW50LnJlcXVlc3RDb250ZXh0Lmh0dHAucGF0aCxcbiAgICAgICAgICAgIG1ldGhvZDogZXZlbnQucmVxdWVzdENvbnRleHQuaHR0cC5tZXRob2QsXG4gICAgICAgICAgICByZXF1ZXN0SWQ6IHJlcXVlc3RJZCB8fCBjb250ZXh0LmF3c1JlcXVlc3RJZFxuICAgICAgICB9KSxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICB9XG4gICAgfTtcbn0pO1xuIl19