"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.handler = void 0;
const aws_logger_1 = require("@vitkuz/aws-logger");
exports.handler = (0, aws_logger_1.withLogger)(async (event, context) => {
    const logger = (0, aws_logger_1.getLogger)();
    if (!logger)
        throw new Error('Logger context missing');
    const headers = event.headers || {};
    // API Gateway V2 lowercases headers
    const requestId = headers['x-request-id'];
    const childLogger = logger.child(requestId ? { [aws_logger_1.REQUEST_ID_KEY]: requestId } : {});
    childLogger.info('HTTP API Handler Invoked', {
        path: event.requestContext.http.path,
        method: event.requestContext.http.method,
        queryParams: event.queryStringParameters,
        requestId
    });
    return {
        statusCode: 200,
        body: JSON.stringify({
            message: 'Hello from Vitkuz Testing HTTP API',
            path: event.requestContext.http.path,
            method: event.requestContext.http.method,
            requestId: requestId || context.awsRequestId
        }),
        headers: {
            'Content-Type': 'application/json'
        }
    };
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaHR0cC1hcGkuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJodHRwLWFwaS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFDQSxtREFBMkU7QUFFOUQsUUFBQSxPQUFPLEdBQUcsSUFBQSx1QkFBVSxFQUFDLEtBQUssRUFBRSxLQUE2QixFQUFFLE9BQWdCLEVBQUUsRUFBRTtJQUN4RixNQUFNLE1BQU0sR0FBRyxJQUFBLHNCQUFTLEdBQUUsQ0FBQztJQUMzQixJQUFJLENBQUMsTUFBTTtRQUFFLE1BQU0sSUFBSSxLQUFLLENBQUMsd0JBQXdCLENBQUMsQ0FBQztJQUV2RCxNQUFNLE9BQU8sR0FBRyxLQUFLLENBQUMsT0FBTyxJQUFJLEVBQUUsQ0FBQztJQUNwQyxvQ0FBb0M7SUFDcEMsTUFBTSxTQUFTLEdBQUcsT0FBTyxDQUFDLGNBQWMsQ0FBQyxDQUFDO0lBRTFDLE1BQU0sV0FBVyxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsMkJBQWMsQ0FBQyxFQUFFLFNBQVMsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUVuRixXQUFXLENBQUMsSUFBSSxDQUFDLDBCQUEwQixFQUFFO1FBQ3pDLElBQUksRUFBRSxLQUFLLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxJQUFJO1FBQ3BDLE1BQU0sRUFBRSxLQUFLLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxNQUFNO1FBQ3hDLFdBQVcsRUFBRSxLQUFLLENBQUMscUJBQXFCO1FBQ3hDLFNBQVM7S0FDWixDQUFDLENBQUM7SUFFSCxPQUFPO1FBQ0gsVUFBVSxFQUFFLEdBQUc7UUFDZixJQUFJLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQztZQUNqQixPQUFPLEVBQUUsb0NBQW9DO1lBQzdDLElBQUksRUFBRSxLQUFLLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxJQUFJO1lBQ3BDLE1BQU0sRUFBRSxLQUFLLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxNQUFNO1lBQ3hDLFNBQVMsRUFBRSxTQUFTLElBQUksT0FBTyxDQUFDLFlBQVk7U0FDL0MsQ0FBQztRQUNGLE9BQU8sRUFBRTtZQUNMLGNBQWMsRUFBRSxrQkFBa0I7U0FDckM7S0FDSixDQUFDO0FBQ04sQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBUElHYXRld2F5UHJveHlFdmVudFYyLCBDb250ZXh0IH0gZnJvbSAnYXdzLWxhbWJkYSc7XG5pbXBvcnQgeyB3aXRoTG9nZ2VyLCBnZXRMb2dnZXIsIFJFUVVFU1RfSURfS0VZIH0gZnJvbSAnQHZpdGt1ei9hd3MtbG9nZ2VyJztcblxuZXhwb3J0IGNvbnN0IGhhbmRsZXIgPSB3aXRoTG9nZ2VyKGFzeW5jIChldmVudDogQVBJR2F0ZXdheVByb3h5RXZlbnRWMiwgY29udGV4dDogQ29udGV4dCkgPT4ge1xuICAgIGNvbnN0IGxvZ2dlciA9IGdldExvZ2dlcigpO1xuICAgIGlmICghbG9nZ2VyKSB0aHJvdyBuZXcgRXJyb3IoJ0xvZ2dlciBjb250ZXh0IG1pc3NpbmcnKTtcblxuICAgIGNvbnN0IGhlYWRlcnMgPSBldmVudC5oZWFkZXJzIHx8IHt9O1xuICAgIC8vIEFQSSBHYXRld2F5IFYyIGxvd2VyY2FzZXMgaGVhZGVyc1xuICAgIGNvbnN0IHJlcXVlc3RJZCA9IGhlYWRlcnNbJ3gtcmVxdWVzdC1pZCddO1xuXG4gICAgY29uc3QgY2hpbGRMb2dnZXIgPSBsb2dnZXIuY2hpbGQocmVxdWVzdElkID8geyBbUkVRVUVTVF9JRF9LRVldOiByZXF1ZXN0SWQgfSA6IHt9KTtcblxuICAgIGNoaWxkTG9nZ2VyLmluZm8oJ0hUVFAgQVBJIEhhbmRsZXIgSW52b2tlZCcsIHtcbiAgICAgICAgcGF0aDogZXZlbnQucmVxdWVzdENvbnRleHQuaHR0cC5wYXRoLFxuICAgICAgICBtZXRob2Q6IGV2ZW50LnJlcXVlc3RDb250ZXh0Lmh0dHAubWV0aG9kLFxuICAgICAgICBxdWVyeVBhcmFtczogZXZlbnQucXVlcnlTdHJpbmdQYXJhbWV0ZXJzLFxuICAgICAgICByZXF1ZXN0SWRcbiAgICB9KTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIHN0YXR1c0NvZGU6IDIwMCxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgbWVzc2FnZTogJ0hlbGxvIGZyb20gVml0a3V6IFRlc3RpbmcgSFRUUCBBUEknLFxuICAgICAgICAgICAgcGF0aDogZXZlbnQucmVxdWVzdENvbnRleHQuaHR0cC5wYXRoLFxuICAgICAgICAgICAgbWV0aG9kOiBldmVudC5yZXF1ZXN0Q29udGV4dC5odHRwLm1ldGhvZCxcbiAgICAgICAgICAgIHJlcXVlc3RJZDogcmVxdWVzdElkIHx8IGNvbnRleHQuYXdzUmVxdWVzdElkXG4gICAgICAgIH0pLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICAgIH1cbiAgICB9O1xufSk7XG4iXX0=